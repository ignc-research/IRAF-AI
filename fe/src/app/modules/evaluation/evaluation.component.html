<div class="container">
  <div class="plots">
    <ng-container *ngIf="firstExperiment; else noExperiments">
      <ng-container *ngFor="let plot of addedPlots; let i = index">
        <div class="plot-wrapper">
          <app-trajectory-plot
            *ngIf="plot.type === 'trajectory'"
            [experimentName]="firstExperiment"
            [dataColumn]="plot.dataColumn">
          </app-trajectory-plot>
          <app-bar-plot
            *ngIf="plot.type === 'bar'"
            [experiments]="[firstExperiment]"
            [dataColumn]="plot.dataColumn"
          ></app-bar-plot>
          <app-line-plot
            *ngIf="plot.type === 'line'"
            [experimentName]="firstExperiment"
            [dataColumn]="plot.dataColumn"
          ></app-line-plot>
          <app-custom-plot
            *ngIf="plot.type === 'custom'"
            [experimentName]="firstExperiment"
            [customPlotCode]="plot.code"
            [elementId]="'custom-plot-' + i">
          </app-custom-plot>

          <button class="close-btn" (click)="removePlot(i)">x</button>
        </div>
      </ng-container>
    </ng-container>
    <ng-template #noExperiments>
      <p>No experiments available.</p>
    </ng-template>
  </div>
  <div class="plot-controls">
    <select [(ngModel)]="selectedPlot">
      <option value="">-- Select a plot --</option>
      <option value="trajectory">Trajectory Plot</option>
      <option value="bar">Bar Plot</option>
      <option value="line">Line Plot</option>
      <option value="custom">Custom Plot</option>
    </select>
    <select [(ngModel)]="selectedDataColumn" [disabled]="!selectedPlot || selectedPlot === 'custom'">
      <option value="">-- Select a data column --</option>
      <option *ngFor="let column of dataColumns" [value]="column">{{ column }}</option>
    </select>
    <div *ngIf="selectedPlot === 'custom'" class="custom-plot-definition">
      <label for="customPlotCode">Custom Plot Definition:</label>
      <textarea [(ngModel)]="customPlotCode" id="customPlotCode" rows="4" cols="50" (keyup)="updateCustomPlotCode()"></textarea>
    </div>
    <button (click)="addPlot()">Add Plot</button>
    <!-- Add this button inside the plot-controls div -->
    <button (click)="openDataTable()">Show Data Table</button>

  </div>
</div>
